import React, { useEffect, useRef, useState } from "react";
import {
  View,
  Text,
  StatusBar,
  Button,
  Alert,
  TouchableOpacity,
  ActivityIndicator,
  FlatList,
  Image,
  ImageBackground,
  ScrollView,
  Linking,
} from "react-native";
import styles from "./Styles";
import { AppIcons, Responsive, Theme } from "../../libs";
import { useAppContext } from "../../Context/AppContext";
import RNHTMLtoPDF from "react-native-html-to-pdf"; // PDF generation
import Share from "react-native-share"; // Sharing library
import RNFS from "react-native-fs"; // File system (if you want to store the PDF)
import { useNavigation } from "@react-navigation/native";
import axios from "axios";
import QRCode from "react-native-qrcode-svg";

import AsyncStorage from "@react-native-async-storage/async-storage";

import { useTranslation } from "react-i18next";
import "../../Translations/i18n";
import { images } from "../../assets";
import NativeModal from "../../Components/Common/NativeModal";

const colors = [
  "#FF0000", // Red
  "#00FF00", // Green
  "#0000FF", // Blue
  "#FFA500", // Orange
  "#800080", // Purple
  "#FFFF00", // Yellow
  "#FFC0CB", // Pink
  "#00FFFF", // Cyan
  "#808080", // Gray
  "#000000", // Black
  "#FFFFFF", // White
  "#A52A2A", // Brown
  "#008000", // Dark Green
  "#ADD8E6", // Light Blue
  "#FFD700", // Gold
  "#FF1493", // Deep Pink
  "#8B0000", // Dark Red
  "#2F4F4F", // Dark Slate Gray
  "#40E0D0", // Turquoise
  "#FF6347", // Tomato
  "#7FFF00", // Chartreuse
  "#DC143C", // Crimson
  "#4682B4", // Steel Blue
  "#DA70D6", // Orchid
  "#B0E0E6", // Powder Blue
  "#D2691E", // Chocolate
  "#F5DEB3", // Wheat
  "#9ACD32", // Yellow Green
  "#708090", // Slate Gray
  "#F08080", // Light Coral
  "#FF7F50", // Coral
  "#6A5ACD", // Slate Blue
  "#20B2AA", // Light Sea Green
  "#FF4500", // Orange Red
  "#BA55D3", // Medium Orchid
  "#CD5C5C", // Indian Red
  "#556B2F", // Dark Olive Green
  "#E6E6FA", // Lavender
  "#6495ED", // Cornflower Blue
  "#FFF8DC", // Cornsilk
  "#F0E68C", // Khaki
  "#191970", // Midnight Blue
  "#87CEEB", // Sky Blue
  "#B22222", // Firebrick
  "#FFE4B5", // Moccasin
  "#ADFF2F", // Green Yellow
  "#9932CC", // Dark Orchid
  "#8FBC8F", // Dark Sea Green
  "#FFB6C1", // Light Pink
  "#C71585", // Medium Violet Red
  "#20B2AA", // Light Sea Green
  "#FF8C00", // Dark Orange
  "#6A5ACD", // Slate Blue
  "#00CED1", // Dark Turquoise
  "#B22222", // Firebrick
  "#3CB371", // Medium Sea Green
];

export default function Template1({ route }) {
  const { getHeight, getWidth } = Responsive;

  const { t, i18n } = useTranslation();

  const {
    selectedClient,
    selectedBusiness,
    selectedItem,
    CapturedSignature,
    selectedLanguage,
    selectedCurrency,
    shippingCharges,
    selectedTerms,
    selectedPayments,
    invoiceNumber,
    invoiceTitle,

    startDate,
    endDate,
    newInvoiveStatus,
    allItemsTotal,
    discountNumber,
    grandTotal,
    selectedTaxItem,
  } = useAppContext();
  const navigation = useNavigation();

  const { invoiceId } = route.params || {}; // Get the passed invoice ID
  const [invoiceDetails, setInvoiceDetails] = useState(null);
  const [loading, setLoading] = useState(true);
  const [selectedColor, setSelectedColor] = useState("");
  const [openHeaderBgModal, setOpenHeaderBgModal] = useState(false);
  const [selectedTextColor, setSelectedTextColor] = useState("");
  const [selectedInvoiceTextColor, setSelectedInvoiceTextColor] = useState("");
  const [selectedSubTitlesColor, setSelectedSubTitlesColor] = useState("");

  const [openHeaderTextModal, setOpenHeaderTextModal] = useState(false);
  const [openTitleTextModal, setOpenTitleTextModal] = useState(false);
  const [openSubTitlesModal, setOpenSubTitlesModal] = useState(false);

  useEffect(() => {
    if (selectedLanguage) {
      i18n.changeLanguage(selectedLanguage);
    }
  }, [selectedLanguage]);

  const getInvoiceDetails = async () => {
    try {
      const token = await AsyncStorage.getItem("userToken");

      setLoading(true);

      const url = `https://invoice-maker-app-wsshi.ondigitalocean.app/api/invoice/${invoiceId}`; // your GET endpoint

      const response = await axios.get(url, {
        headers: {
          Authorization: `Bearer ${token}`, // include token for auth
        },
      });

      if (response.status === 200) {
        console.log("✅ Invoices fetched:", response.data);
        // You can set this to state for FlatList
        // setInvoices(response.data);
        // setInvoiceDetails(response.data);
        setInvoiceDetails(response.data || { items: [] });
      }
    } catch (error) {
      console.log(
        "❌ Error fetching invoices:",
        error.response?.data || error.message
      );
      Alert.alert("Error", error.message);
    } finally {
      setLoading(false);
    }
  };

  useEffect(() => {
    getInvoiceDetails();
  }, [invoiceId]);

  if (loading) {
    return <ActivityIndicator size="large" color="#0000ff" />;
  }

  // Dynamically calculate total amount
  const totalAmount = invoiceDetails?.items?.length
    ? invoiceDetails.items.reduce(
        (sum, item) => sum + parseFloat(item.amount || 0),
        0
      )
    : selectedItem.reduce(
        (sum, item) => sum + parseFloat(item.totalAmount || 0),
        0
      );

  // Function to generate the item rows dynamically
  const generateItemRows = (items) => {
    return items
      .map(
        (item) => `
      <tr>
        <td>${item.itemName || "N/A"}</td>
        <td>${item.itemQuantity || "N/A"}</td>
        <td>${item.itemPrice || "N/A"}</td>
        <td>${item.discount + "%" || "N/A"}</td>

        <td>${
          item.total || (item.itemPrice * item.itemQuantity).toFixed(2)
        }</td>
      </tr>
    `
      )
      .join("");
  };

  const generateTaxRows = (taxes) => {
    return taxes
      .map(
        (tax) => `

        <div style="display: flex; justify-content: space-between;">
        <span style="font-weight: 600; font-size: 22px;">  ${tax.taxName}</span>
        <span style="font-size: 22px;">
        ${tax.taxRate}%
        </span>
        </div>
      `
      )
      .join("");
  };

  const handleSharePDF = async () => {
    try {
      // Dynamically create rows from selected items or invoice details
      const itemRows =
        invoiceDetails?.items && invoiceDetails.items.length > 0
          ? generateItemRows(invoiceDetails.items)
          : generateItemRows(selectedItem);

      const taxRows =
        invoiceDetails?.taxes && invoiceDetails.taxes.length > 0
          ? generateTaxRows(invoiceDetails.taxes)
          : generateTaxRows(selectedTaxItem);

      // Generate the PDF
      const options = {
        html: `
        <html>
        <head>
        <style>
        * {
          -webkit-print-color-adjust: exact !important;
          print-color-adjust: exact !important;
        }
      </style>

        <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
        <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap');
        
          body {
            font-family: 'Montserrat', sans-serif;
      color: #333;
      margin: 0;
      padding: 0;
      // background-image: url('https://www.highhillstours.pk/wp-content/uploads/2025/07/pinkTemplate.png');
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
    }
    
    
          .container {
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            /*background-color: #ffffff;*/
            // border: 1px solid #ddd;
            // box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            position: relative;
          }
    
          .logo {
            position: absolute;
            top: 15px;
            margin-left: 10px;
          }
    
          .logo img {
            width: 100px; /* Adjust the size as needed */
            height: auto;
          }
    
          .header {
            text-align: center;
            margin-bottom: 30px;
          }
    
          .header h1 {
            font-size: 36px;
            color: #000;
            margin: 0;
          }
    
          .invoice-details {
                 margin-top: 10.5%;
            text-align: right;
            margin-bottom: 20px;
            margin-right: 20px;
          }
    
          .invoice-details p {
            margin: 5px 0;
            font-size: 20px;
          }
    
          .invoice-details .bold {
            font-weight: bold;
          }
    
          .section {
            margin-bottom: 20px;
          }
    
          .contact-info {
               /*margin-top: 10px;*/
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            margin-right: 20px;
          }
    
          .from,
          .bill-to {
            width: 48%;
            margin-right: 5px;
          }
    
          .from {
            text-align: left;
            margin-left: 20px;
          }
    
          .bill-to {
            text-align: right;
          }
    
          .section h2 {
            font-size: 28px;
            color: #000;
            margin-bottom: 10px;
          }
    
          .section p {
            font-size: 20px;
            line-height: 1.6;
            margin: 5px 0;
          }
    
          .table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
          }
    
          .table th,
          .table td {
            padding: 12px;
            text-align: center;
            border-bottom: 1px solid #ddd;
            
          }
    
          .table th {
            background-color:${selectedColor ? selectedColor : "#ff5857"};
            color:${selectedTextColor ? selectedTextColor : Theme.colors.white};
            font-size: 18px;
          
          }
          
    
          .table td {
            font-size: 22px;
          }
    
          .footer {
            text-align: center;
            margin-top: 30px;
            font-size: 12px;
            color: #888;
          }
    
          .footer p {
            margin: 5px 0;
          }
    
          .invoice-image {
            text-align: right;
            margin-top: 20px;
            margin-right: 25px;
          }
    
          .invoice-image img {
            width: 100px;
            height: auto;
          }
    
          .summary p {
            text-align: right;
            font-size: 20px;
            font-weight: bold;
            margin: 5px 0;
            margin-right:20px;
          }
        </style>
      </head>
        <body style="position: relative; margin:0; padding:0;">
        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABYYAAAfQCAYAAAB2Xou3AAAACXBIWXMAABpMAAAaTAEcLDmcAAAFE2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSfvu78nIGlkPSdXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQnPz4KPHg6eG1wbWV0YSB4bWxuczp4PSdhZG9iZTpuczptZXRhLyc+CjxyZGY6UkRGIHhtbG5zOnJkZj0naHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyc+CgogPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9JycKICB4bWxuczpBdHRyaWI9J2h0dHA6Ly9ucy5hdHRyaWJ1dGlvbi5jb20vYWRzLzEuMC8nPgogIDxBdHRyaWI6QWRzPgogICA8cmRmOlNlcT4KICAgIDxyZGY6bGkgcmRmOnBhcnNlVHlwZT0nUmVzb3VyY2UnPgogICAgIDxBdHRyaWI6Q3JlYXRlZD4yMDI1LTA4LTIzPC9BdHRyaWI6Q3JlYXRlZD4KICAgICA8QXR0cmliOkV4dElkPmQyNDViNjdhLWQ0MTEtNGU4My04ZGQ3LWNjNGE3ODAwYTQxNDwvQXR0cmliOkV4dElkPgogICAgIDxBdHRyaWI6RmJJZD41MjUyNjU5MTQxNzk1ODA8L0F0dHJpYjpGYklkPgogICAgIDxBdHRyaWI6VG91Y2hUeXBlPjI8L0F0dHJpYjpUb3VjaFR5cGU+CiAgICA8L3JkZjpsaT4KICAgPC9yZGY6U2VxPgogIDwvQXR0cmliOkFkcz4KIDwvcmRmOkRlc2NyaXB0aW9uPgoKIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PScnCiAgeG1sbnM6ZGM9J2h0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvJz4KICA8ZGM6dGl0bGU+CiAgIDxyZGY6QWx0PgogICAgPHJkZjpsaSB4bWw6bGFuZz0neC1kZWZhdWx0Jz5XaGl0ZSBHcmVlbiBTaW1wbGUgQ2xlYW4gQnVzaW5lc3MgQ29udHJhY3RvciBJbnZvaWNlICAtIDE8L3JkZjpsaT4KICAgPC9yZGY6QWx0PgogIDwvZGM6dGl0bGU+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AGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMBMAAAD//+zYgQAAAACAIH/rQS6MxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAICZAAAA///s2IEAAAAAgCB/60EujMQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADATAAAA///s2IEAAAAAgCB/60EujMQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAmQAAAP//7NiBAAAAAIAgf+tBLozEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwEwAAAP//7NiBAAAAAIAgf+tBLozEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgJkAAAD//+zYgQAAAACAIH/rQS6MxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMBMAAAD//+zYgQAAAACAIH/rQS6MxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAICZAAAA///s2IEAAAAAgCB/60EujMQwAAAAAMCMGAYA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AAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMBMAAAD//+zYgQAAAACAIH/rQS6MxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAICZAAAA///s2IEAAAAAgCB/60EujMQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADATAAAA///s2IEAAAAAgCB/60EujMQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAmQAAAP//7NiBAAAAAIAgf+tBLozEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwEwAAAP//7NiBAAAAAIAgf+tBLozEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgJkAAAD//+zYgQAAAACAIH/rQS6MxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMBMAAAD//+zYgQAAAACAIH/rQS6MxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAICZAAAA///s2IEAAAAAgCB/60EujMQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADATAAAA///s2IEAAAAAgCB/60EujMQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAmQAAAP//7NiBAAAAAIAgf+tBLozEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwEwAAAP//7NiBAAAAAIAgf+tBLozEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgJkAAAD//+zYgQAAAACAIH/rQS6MxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMBMAAAD//+zYgQAAAACAIH/rQS6MxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAICZAAAA///s2IEAAAAAgCB/60EujMQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADATAAAA///s2IEAAAAAgCB/60EujMQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAmQAAAP//7NiBAAAAAIAgf+tBLozEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwEwAAAP//7NiBAAAAAIAgf+tBLozEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgJkAAAD//+zYgQAAAACAIH/rQS6MxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMBMAAAD//+zYgQAAAACAIH/rQS6MxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAICZAAAA///s2IEAAAAAgCB/60EujMQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAA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" 
             style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: -1;" />
        <div style="position: relative; z-index: 1;">
          
        </div>

        <div class="container">
        <!-- Logo Section -->
        <div class="logo">
          <img
            src="${
              selectedBusiness
                ? selectedBusiness.imageUrl
                : invoiceDetails.businessLogo
            }"
           
          />
        </div>
  
      



    



        <!-- Invoice Name and Date Section -->
        <div class="section contact-info">
          <div class="from">



          <div class="logo">
          <img
            src="${
              selectedBusiness
                ? selectedBusiness.imageUrl
                : invoiceDetails.businessLogo
            }"
           
          />
        </div>

       
    
          
            <h1 style="font-size: 60px; font-weight: bold; color:${
              selectedInvoiceTextColor
                ? selectedInvoiceTextColor
                : Theme.colors.black
            }; text-align: center; margin-top: 40px; margin-bottom: 20px;">
            INVOICE
          </h1>
         
        
          </div>



          <div class="bill-to">
 
            <div class="invoice-details">
            <p style="color:${
              selectedSubTitlesColor
                ? selectedSubTitlesColor
                : Theme.colors.black
            };" >
              <span  class="bold" >INVOICE#</span>
              ${invoiceNumber ? invoiceNumber : invoiceDetails.invoiceNumber}
            </p>
            <p style="color:${
              selectedSubTitlesColor
                ? selectedSubTitlesColor
                : Theme.colors.black
            };" >
              <span   class="bold">${t("dateCreated")}</span>
              ${
                startDate
                  ? startDate
                  : new Date(invoiceDetails.dateCreated)
                      .toISOString()
                      .split("T")[0]
              }
              
            </p>
            <p style="color: ${
              selectedSubTitlesColor
                ? selectedSubTitlesColor
                : Theme.colors.black
            };" >
              <span  class="bold">${t("dueDate")}:</span>
              ${endDate ? endDate : invoiceDetails.DueIn}
            </p>
            </div>








          </div>
        </div>








  
        <!-- From and Bill To Section -->
        <div class="section contact-info">
          <div class="from">
            <h2 style="color: ${
              selectedSubTitlesColor
                ? selectedSubTitlesColor
                : Theme.colors.black
            };">${t("from")}</h2>
            <p>
              <strong>${
                selectedBusiness
                  ? selectedBusiness.businessName
                  : invoiceDetails.businessName
              }</strong>
            </p>
            <p>
              ${
                selectedBusiness
                  ? selectedBusiness.email
                  : invoiceDetails.businessEmail
              }
            </p>
            <p>
              ${
                selectedBusiness
                  ? selectedBusiness.phone
                  : invoiceDetails.businessPhone
              }
            </p>
          </div>
          <div class="bill-to">
            <h2 style="color: ${
              selectedSubTitlesColor
                ? selectedSubTitlesColor
                : Theme.colors.black
            };">${t("billTo")}</h2>
            <p>
              <strong>${
                selectedClient
                  ? selectedClient.clientName
                  : invoiceDetails.clientName
              }</strong>
            </p>
            <p>
              ${
                selectedClient
                  ? selectedClient.email
                  : invoiceDetails.clientEmail
              }
            </p>
            <p>
              ${
                selectedClient
                  ? selectedClient.phone
                  : invoiceDetails.clientPhone
              }
            </p>
          </div>
        </div>
  
        <!-- Items Table -->
        <div class="section">
          <table class="table">
            <thead>
              <tr>
                <th>${t("items")}</th>
                <th>${t("quantity")}</th>
                <th>${t("price")} (${
          selectedCurrency ? selectedCurrency : invoiceDetails.currency
        })</th>
                <th>${t("discount")}%</th>
                <th>${t("total")} (${
          selectedCurrency ? selectedCurrency : invoiceDetails.currency
        })</th>
              </tr>
            </thead>
            <tbody>
              ${itemRows}
            </tbody>
          </table>






          <!-- Payment Terms and Total Section -->
          <div class="section contact-info">
            <div class="from">

            <!-- Terms Section -->
            <div class="payment-method">
              <h3 style="margin: 0 0 5px 0; font-size: 20px; font-weight: bold; color: ${
                selectedSubTitlesColor
                  ? selectedSubTitlesColor
                  : Theme.colors.black
              };">Terms & Conditions</h3>
              <p style="margin: 0 0 0px 0; font-size: 18px;">
              ${
                selectedTerms
                  ? selectedTerms.termsDesc
                  : invoiceDetails?.termsConditions
              }
              </p>

            

            
            
            </div>

            <!-- Payment Method Section -->
            <div class="payment-method">
              <h3 style="margin: 15 0 5px 0; font-size: 20px; font-weight: bold; color: ${
                selectedSubTitlesColor
                  ? selectedSubTitlesColor
                  : Theme.colors.black
              };"">Payment Method</h3>
              <p style="margin: 0 0 0px 0; font-size:18px;">
              ${
                selectedPayments
                  ? selectedPayments.paymentMethod || ""
                  : invoiceDetails?.paymentMethod || ""
              }
              </p>
              <p style="margin: 0 0 0px 0; font-size: 18px;">
              ${
                selectedPayments
                  ? selectedPayments.paymentDesc || ""
                  : invoiceDetails?.paymentDesc || ""
              }
              </p>
            </div>

            <!-- QR Code + Text Side by Side -->
            <div style="display: inline-flex; align-items: center; gap: 10px; margin-top: 10px;">
              <a href="${
                selectedPayments?.paymentLink || invoiceDetails?.paymentLink
              }" target="_blank">
                <img 
                  src="https://api.qrserver.com/v1/create-qr-code/?size=70x70&data=${
                    selectedPayments?.paymentLink || invoiceDetails?.paymentLink
                  }" 
                  alt="QR Code"
                  style="display: block; cursor: pointer;"
                />
              </a>
              <a href="${
                selectedPayments?.paymentLink || invoiceDetails?.paymentLink
              }" target="_blank" 
                 style="font-size: 18px; font-weight: bold; color: ${
                   selectedSubTitlesColor
                     ? selectedSubTitlesColor
                     : Theme.colors.black
                 };"; text-decoration: none;">
                Scan or Click & Pay
              </a>
            </div>
  
         
          
           
            
            
            </div>
            <div class="bill-to">

            <div style="display: flex; justify-content: space-between;">
  <span style="font-weight: 600; font-size: 22px;">Total:</span>
  <span style="font-size: 22px;">
    ${
      selectedCurrency
        ? selectedCurrency.currencySymbol
        : invoiceDetails?.currency
    } ${(allItemsTotal ?? invoiceDetails.itemsTotal ?? 0).toFixed(2)}
  </span>
</div>

<div style="display: flex; justify-content: space-between;">
<span style="font-weight: 600; font-size: 22px;">Shipping:</span>
<span style="font-size: 22px;">
${selectedCurrency ? selectedCurrency.currencySymbol : invoiceDetails?.currency}
${(shippingCharges ?? invoiceDetails?.shipping ?? 0).toFixed(2)}
</span>
</div>

<div style="display: flex; justify-content: space-between;">
<span style="font-weight: 600; font-size: 22px;">Discount:</span>
<span style="font-size: 22px;">
${discountNumber ?? invoiceDetails.discount ?? 0}% 
</span>
</div>

${taxRows}


        
          
        
        
            <!-- Grand Total Row (Red Background) -->

            <div style="display: flex; justify-content: space-between; background-color: ${
              selectedColor ? selectedColor : "#ff5857"
            };  color:${
          selectedTextColor ? selectedTextColor : Theme.colors.white
        }; padding: 9px; margin-top: 10px;">
            <span style="font-weight:800; font-size: 22px;">Sub Total:</span>
            <span style="font-size: 22px; font-weight:800;">
            ${
              selectedCurrency
                ? selectedCurrency.currencySymbol
                : invoiceDetails.currency
            }
            ${
              grandTotal
                ? grandTotal.toFixed(2)
                : invoiceDetails.amount.toFixed(2)
            }
            </span>
            </div>











           
   
             
            </div>
          </div>


</div>
        
     
        

  
       
  
        <!-- Signature -->
        <div class="invoice-image">
          <img
            src="${
              CapturedSignature
                ? CapturedSignature
                : invoiceDetails.CapturedSignature
            }"
            alt="${t("signature")}"
          />
          <p>${t("signature")}</p>
        </div>
      </div>
      </body>



      
      
      </html>


      
      `,
        fileName: "invoice",
      
        directory: Platform.OS === "ios" ? "Documents" : undefined,
      };

      const pdf = await RNHTMLtoPDF.convert(options);
      const { filePath } = pdf;

      Alert.alert("Success", `PDF generated at ${filePath}`);

      const shareOptions = {
        title: "Share Invoice",
        url: Platform.OS === "android" ? `file://${filePath}` : filePath,
        type: "application/pdf",
        failOnCancel: false
      };

      await Share.open(shareOptions);
    } catch (error) {
      console.error("Error generating or sharing PDF", error);
      Alert.alert("Error", "There was an issue generating or sharing the PDF.");
    }
  };

  return (
    <View style={styles.container}>
      <StatusBar translucent backgroundColor={"transparent"} />
      <View style={styles.header}>
        <View style={styles.headerArrowAndText}>
          <AppIcons.backArrow size={27} color={Theme.colors.white} />
          <Text style={styles.headingText}>Template 2</Text>
        </View>
        <AppIcons.DoneIcon size={27} color={Theme.colors.white} />
      </View>
      <ScrollView>
      <ImageBackground
          source={images.newBlueTemplate}
          style={styles.blueTemplate}
        >
          <TouchableOpacity
            onPress={() =>
              navigation.navigate("Template2", { invoiceId: invoiceId })
            }
            style={styles.dataBox}
          >
            {(selectedBusiness?.logo || invoiceDetails?.businessLogo) && (
              <View style={styles.logoWrapper}>
                <Image
                  style={styles.businessLogo}
                  source={{
                    uri: selectedBusiness?.logo || invoiceDetails?.businessLogo,
                  }}
                />
              </View>
            )}

            <View
              style={[
                styles.dataBoxInner,
                !(selectedBusiness?.logo || invoiceDetails?.businessLogo) && {
                  marginTop: getHeight(5),
                },
              ]}
            >
              <View style={styles.invAndMeta}>
                <View>
                  <Text style={[styles.invTitle,{color:Theme.colors.white}]}>
                    {invoiceTitle ? invoiceTitle : invoiceDetails?.invoiceTitle}
                  </Text>
                </View>

                <View style={styles.metaWrap}>
                  <View>
                    <Text style={[styles.invTitleText,{color:Theme.colors.white}]}>{t("invoiceTitle")}</Text>
                    <Text style={[styles.invTitleText,{color:Theme.colors.white}]}>{t("dateCreated")}</Text>

                    {invoiceDetails?.Status === "UNPAID" && (
                    <Text style={[styles.invTitleText,{color:Theme.colors.white}]}>{t("dueDate")}</Text>
                    )}
                    {invoiceDetails?.Status === "PAID" && (
                       <Text style={[styles.invTitleText,{color:Theme.colors.white}]}>INVOICE STATUS</Text>
                    )}
                    {newInvoiveStatus === "PAID" && (
                    <Text style={[styles.invTitleText,{color:Theme.colors.white}]}>INVOICE STATUS</Text>
                    )}
                  </View>
                  <View>
                    <Text style={[styles.invDescText,{color:Theme.colors.white}]}>
                      {invoiceNumber
                        ? invoiceNumber
                        : invoiceDetails?.invoiceNumber}
                    </Text>

                    <Text style={[styles.invDescText,{color:Theme.colors.white}]}>
                      {
                        startDate
                          ? startDate
                          : invoiceDetails?.dateCreated
                          ? new Date(invoiceDetails.dateCreated)
                              .toISOString()
                              .split("T")[0]
                          : "" // fallback if no date
                      }
                    </Text>

                    {invoiceDetails?.Status === "UNPAID" && (
                       <Text style={[styles.invDescText,{color:Theme.colors.white}]}>
                        {endDate
                          ? new Date(endDate).toISOString().split("T")[0]
                          : invoiceDetails?.DueIn
                          ? new Date(invoiceDetails.DueIn)
                              .toISOString()
                              .split("T")[0]
                          : ""}
                      </Text>
                    )}

                    {invoiceDetails?.Status === "PAID" && (
                    <Text style={[styles.invDescText,{color:Theme.colors.white}]}>PAID</Text>
                    )}
                    {newInvoiveStatus === "PAID" && (
                       <Text style={[styles.invDescText,{color:Theme.colors.white}]}>PAID</Text>
                    )}
                  </View>
                </View>
              </View>
            </View>
            <View style={[styles.border,{borderBlockColor:Theme.colors.white}]} />
            <View style={styles.fromandToWrap}>
              <View>
                <Text style={[styles.fromTitle,{color:Theme.colors.white}]}>{t("from")}</Text>
                <Text style={[styles.fromDesc,{color:Theme.colors.white}]}>
                  {selectedBusiness
                    ? selectedBusiness.businessName
                    : invoiceDetails?.businessName}
                </Text>
                <Text style={[styles.fromDesc,{color:Theme.colors.white}]}>
                  {selectedBusiness
                    ? selectedBusiness.email
                    : invoiceDetails?.businessEmail}
                </Text>
                <Text style={[styles.fromDesc,{color:Theme.colors.white}]}>
                  {selectedBusiness
                    ? selectedBusiness.phone
                    : invoiceDetails?.businessPhone}
                </Text>
              </View>
              <View>
                <Text style={[styles.fromTitle,{color:Theme.colors.white}]}>{t("billTo")}</Text>
                <Text style={[styles.fromDesc,{color:Theme.colors.white}]}>
                  {selectedClient
                    ? selectedClient.clientName
                    : invoiceDetails?.clientName}
                </Text>
                <Text style={[styles.fromDesc,{color:Theme.colors.white}]}>
                  {selectedClient
                    ? selectedClient.email
                    : invoiceDetails?.clientEmail}
                </Text>
                <Text style={[styles.fromDesc,{color:Theme.colors.white}]}>
                  {selectedClient
                    ? selectedClient.phone
                    : invoiceDetails?.clientPhone}
                </Text>
              </View>
            </View>

            {/* items headings */}
            <View
              style={[styles.headingMainWrap, { backgroundColor: Theme.colors.white }]}
            >
              <View style={[styles.itemHeadWrap, { width: getWidth(31) }]}>
                <Text style={[styles.headText,{color:Theme.colors.black}]}>{t("items")}</Text>
              </View>
              <View style={[styles.itemHeadWrap, { width: getWidth(13) }]}>
              <Text style={[styles.headText,{color:Theme.colors.black}]}>{t("quantity")}</Text>
              </View>
              <View style={[styles.itemHeadWrap, { width: getWidth(14) }]}>
              <Text style={[styles.headText,{color:Theme.colors.black}]}>
                  {t("price")} (
                  {selectedCurrency
                    ? selectedCurrency?.currencyCode
                    : invoiceDetails?.currency}
                  )
                </Text>
              </View>
              <View style={[styles.itemHeadWrap, { width: getWidth(11) }]}>
              <Text style={[styles.headText,{color:Theme.colors.black}]}>
                  {t("discount")}</Text>
              </View>

              <View style={[styles.itemHeadWrap, { width: getWidth(16) }]}>
              <Text style={[styles.headText,{color:Theme.colors.black}]}>
                  {t("total")} (
                  {selectedCurrency
                    ? selectedCurrency?.currencyCode
                    : invoiceDetails?.currency}
                  )
                </Text>
              </View>
            </View>

            <View>
              <FlatList
                data={
                  invoiceDetails?.items && invoiceDetails?.items.length > 0
                    ? invoiceDetails.items
                    : selectedItem
                }
                renderItem={({ item }) => (
                  <View style={[styles.itemsMainWrap,{borderBottomColor:Theme.colors.white}]}>
                    <View
                      style={[
                        styles.itemDataCell,
                        { width: getWidth(28.5), marginLeft: getWidth(2) },
                      ]}
                    >
                      <Text style={[styles.itemName,{color:Theme.colors.white}]}>{item.itemName}</Text>
                    </View>
                    <View style={styles.itemsWrap}>
                      <View
                        style={[
                          styles.itemDataCell,
                          { width: getWidth(12), marginLeft: getWidth(1) },
                        ]}
                      >
                        <Text style={[styles.perItemStyle,{color:Theme.colors.white}]}>
                          {item.itemQuantity} {item.unit} ✕
                        </Text>
                      </View>

                      <View
                        style={[
                          styles.itemDataCell,
                          { width: getWidth(13.1), marginLeft: getWidth(1) },
                        ]}
                      >
                        <Text style={[styles.perItemStyle,{color:Theme.colors.white}]}>
                          {item.itemPrice}{" "}
                        </Text>
                      </View>

                      <View
                        style={[
                          styles.itemDataCell,
                          { width: getWidth(10), marginLeft: getWidth(1) },
                        ]}
                      >
                        {item.discount >= 1 ? (
                          <Text style={[styles.perItemStyle,{color:Theme.colors.white}]}>
                            {item.discount}%
                          </Text>
                        ) : (
                          <Text style={[styles.perItemStyle,{color:Theme.colors.white}]}>--</Text>
                        )}
                      </View>

                      <View
                        style={[
                          styles.itemDataCell,
                          { width: getWidth(15), marginLeft: getWidth(1) },
                        ]}
                      >
                        <Text style={[styles.perItemStyle,{color:Theme.colors.white}]}>
                          {item.totalAmount}
                        </Text>
                      </View>
                    </View>
                  </View>
                )}
              />
            </View>

            <View style={styles.paymentAndgrandsMainWrap}>
              {/* payments start */}

              <View style={styles.paymentAndTermsWrap}>
                {selectedTerms?.termsDesc || invoiceDetails?.termsConditions ? (
                  <View style={styles.paymentAndTermsWrap}>
                    <Text style={[styles.termsTitle,{color:Theme.colors.white}]}>Terms and Conditions</Text>
                    <Text style={[styles.termsDesc,{color:Theme.colors.white}]}>
                      {selectedTerms?.termsDesc ||
                        invoiceDetails?.termsConditions}
                    </Text>
                  </View>
                ) : null}

                {selectedPayments?.paymentMethod ||
                selectedPayments?.paymentDesc ||
                invoiceDetails?.paymentMethod ||
                invoiceDetails?.paymentDesc ? (
                  <View style={styles.paymentAndTermsWrap}>
                    <Text style={[styles.termsTitle,{color:Theme.colors.white}]}>Payment Method</Text>
                    <Text style={[styles.termsDesc,{color:Theme.colors.white}]}>
                      {selectedPayments?.paymentMethod ||
                        invoiceDetails?.paymentMethod}
                    </Text>
                    <Text style={[styles.termsDesc,{color:Theme.colors.white}]}>
                      {selectedPayments?.paymentDesc ||
                        invoiceDetails?.paymentDesc}
                    </Text>
                  </View>
                ) : null}

                {(selectedPayments?.paymentLink ||
                  invoiceDetails?.paymentLink) && (
                  <View style={styles.qrMainWrap}>
                    <TouchableOpacity
                      onPress={() =>
                        Linking.openURL(
                          selectedPayments?.paymentLink ||
                            invoiceDetails?.paymentLink
                        )
                      }
                      style={{
                        marginTop: getHeight(0.5),
                        marginLeft: getWidth(2.5),
                      }}
                    >
                      <QRCode
                        value={
                          selectedPayments?.paymentLink ||
                          invoiceDetails?.paymentLink
                        }
                        size={30}
                      />
                    </TouchableOpacity>
                    <Text style={[styles.termsTitle,{color:Theme.colors.white}]}>Scan or Click & Pay</Text>
                  </View>
                )}
              </View>

              {/* payments end */}

              {/* total start */}
              <View style={styles.grandTotalWrap}>
                <View style={styles.singleGrandRow}>
                  <Text style={[styles.grandTotalText,{color:Theme.colors.white}]}>Total</Text>
                  <Text style={[styles.grandTotalText,{color:Theme.colors.white}]}>
                    {selectedCurrency
                      ? selectedCurrency.currencyCode
                      : invoiceDetails?.currency}{" "}
                    {(allItemsTotal ?? invoiceDetails.itemsTotal ?? 0).toFixed(
                      2
                    )}
                  </Text>
                </View>

                {shippingCharges >= 1 || invoiceDetails?.shipping >= 1 ? (
                  <View style={styles.singleGrandRow}>
                    <Text style={[styles.grandTotalText,{color:Theme.colors.white}]}>Shipping</Text>
                    <Text style={[styles.grandTotalText,{color:Theme.colors.white}]}>
                      {"              "}{" "}
                      {selectedCurrency
                        ? selectedCurrency.currencyCode
                        : invoiceDetails?.currency}{" "}
                      {(
                        shippingCharges ??
                        invoiceDetails?.shipping ??
                        0
                      ).toFixed(2)}
                    </Text>
                  </View>
                ) : null}

                {discountNumber >= 1 || invoiceDetails?.discount >= 1 ? (
                  <View style={styles.singleGrandRow}>
                    <Text style={[styles.grandTotalText,{color:Theme.colors.white}]}>
                      Discount</Text>
                      <Text style={[styles.grandTotalText,{color:Theme.colors.white}]}>
                      {discountNumber ?? invoiceDetails.discount ?? 0}%
                    </Text>
                  </View>
                ) : null}

                <FlatList
                  data={
                    invoiceDetails?.taxes && invoiceDetails?.taxes.length > 0
                      ? invoiceDetails.taxes
                      : selectedTaxItem
                  }
                  renderItem={({ item }) => (
                    <View style={styles.singleGrandRow}>
                         <Text style={[styles.grandTotalText,{color:Theme.colors.white}]}>
                        {item.taxName}</Text>
                        <Text style={[styles.grandTotalText,{color:Theme.colors.white}]}>
                        {item.taxRate}%</Text>
                    </View>
                  )}
                />

                <View
                  style={[
                    styles.singleGrandRow,
                    {
                      backgroundColor: Theme.colors.white,
                    },
                  ]}
                >
                  <Text
                    style={[
                      styles.grandTotalText,
                      { color: Theme.colors.black },
                    ]}
                  >
                    Sub Total{" "}
                  </Text>
                  <Text
                    style={[
                      styles.grandTotalText,
                      { color: Theme.colors.black },
                    ]}
                  >
                    {selectedCurrency
                      ? selectedCurrency.currencyCode
                      : invoiceDetails.currency}{" "}
                    {grandTotal
                      ? grandTotal.toFixed(2)
                      : invoiceDetails.amount.toFixed(2)}
                  </Text>
                </View>
              </View>

              {/* total end */}
            </View>

            {/* here was that code */}

            {newInvoiveStatus === "PAID" && (
              <View>
                <Image style={styles.paidIcon} source={images.paidIcon} />
              </View>
            )}

            {invoiceDetails?.Status === "PAID" && (
              <View>
                <Image style={styles.paidIcon} source={images.paidIcon} />
              </View>
            )}

            <View style={styles.paymentAndSignatureWrap}>
              <View style={[styles.signatureWrap,{borderBottomColor:Theme.colors.white}]}>
                <Image
                  style={[styles.signatureStyle,{tintColor:Theme.colors.white}]}
                  source={{
                    uri: CapturedSignature
                      ? CapturedSignature
                      : invoiceDetails?.CapturedSignature,
                  }}
                />
              </View>
            </View>
          </TouchableOpacity>
        </ImageBackground>

        <NativeModal
          visible={openHeaderBgModal}
          modalTitle={"Header BG Color"}
          children={
            <View style={{ height: getHeight(44) }}>
              <View style={{ alignSelf: "center" }}>
                <FlatList
                  data={colors}
                  numColumns={8} // adjust columns
                  keyExtractor={(item) => item}
                  renderItem={({ item }) => (
                    <TouchableOpacity
                      onPress={() => {
                        setSelectedColor(item);
                        setOpenHeaderBgModal(false);
                      }}
                      style={{
                        backgroundColor: item,
                        width: getWidth(8),
                        height: getHeight(4.5),
                        margin: 5,
                        borderRadius: getHeight(1),
                        borderWidth: selectedColor === item ? 3 : 0,
                        borderColor: "black",
                      }}
                    />
                  )}
                />
                <Text
                  onPress={() => {
                    setSelectedColor(null);
                    setOpenHeaderBgModal(false);
                  }}
                >
                  Reset Color
                </Text>
              </View>
            </View>
          }
        />

        <NativeModal
          visible={openHeaderTextModal}
          modalTitle={"Header Text Color"}
          children={
            <View style={{ height: getHeight(44) }}>
              <View style={{ alignSelf: "center" }}>
                <FlatList
                  data={colors}
                  numColumns={8} // adjust columns
                  keyExtractor={(item) => item}
                  renderItem={({ item }) => (
                    <TouchableOpacity
                      onPress={() => {
                        setSelectedTextColor(item);
                        setOpenHeaderTextModal(false);
                      }}
                      style={{
                        backgroundColor: item,
                        width: getWidth(8),
                        height: getHeight(4.5),
                        margin: 5,
                        borderRadius: getHeight(1),
                        borderWidth: selectedColor === item ? 4 : 0.5,
                        borderColor: "black",
                      }}
                    />
                  )}
                />
                <Text
                  onPress={() => {
                    setSelectedTextColor(null);
                    setOpenHeaderTextModal(false);
                  }}
                >
                  Reset Color
                </Text>
              </View>
            </View>
          }
        />

        <NativeModal
          visible={openTitleTextModal}
          modalTitle={"Titles Text Color"}
          children={
            <View style={{ height: getHeight(44) }}>
              <View style={{ alignSelf: "center" }}>
                <FlatList
                  data={colors}
                  numColumns={8} // adjust columns
                  keyExtractor={(item) => item}
                  renderItem={({ item }) => (
                    <TouchableOpacity
                      onPress={() => {
                        setSelectedInvoiceTextColor(item);
                        setOpenTitleTextModal(false);
                      }}
                      style={{
                        backgroundColor: item,
                        width: getWidth(8),
                        height: getHeight(4.5),
                        margin: 5,
                        borderRadius: getHeight(1),
                        borderWidth: selectedColor === item ? 4 : 0.5,
                        borderColor: "black",
                      }}
                    />
                  )}
                />
                <Text
                  onPress={() => {
                    setSelectedInvoiceTextColor(null);
                    setOpenTitleTextModal(false);
                  }}
                >
                  Reset Color
                </Text>
              </View>
            </View>
          }
        />

        <NativeModal
          visible={openSubTitlesModal}
          modalTitle={"Sub Titles Color"}
          children={
            <View style={{ height: getHeight(44) }}>
              <View style={{ alignSelf: "center" }}>
                <FlatList
                  data={colors}
                  numColumns={8} // adjust columns
                  keyExtractor={(item) => item}
                  renderItem={({ item }) => (
                    <TouchableOpacity
                      onPress={() => {
                        setSelectedSubTitlesColor(item);
                        setOpenSubTitlesModal(false);
                      }}
                      style={{
                        backgroundColor: item,
                        width: getWidth(8),
                        height: getHeight(4.5),
                        margin: 5,
                        borderRadius: getHeight(1),
                        borderWidth: selectedColor === item ? 4 : 0.5,
                        borderColor: "black",
                      }}
                    />
                  )}
                />
                <Text
                  onPress={() => {
                    setSelectedSubTitlesColor(null);
                    setOpenSubTitlesModal(false);
                  }}
                >
                  Reset Color
                </Text>
              </View>
            </View>
          }
        />

        <Text onPress={() => setOpenHeaderBgModal(true)}>
          Select Heading Bg Color
        </Text>

        <Text onPress={() => setOpenHeaderTextModal(true)}>
          Select Heading Text Color
        </Text>

        <Text onPress={() => setOpenTitleTextModal(true)}>Invoice Title</Text>

        <Text onPress={() => setOpenSubTitlesModal(true)}>Sub Titles</Text>

        <Text style={{ color: selectedSubTitlesColor }}>head</Text>

        <Button title="Share" onPress={handleSharePDF} />
      </ScrollView>
    </View>
  );
}
