import React, { useEffect, useRef, useState } from "react";
import {
  View,
  Text,
  StatusBar,
  Button,
  Alert,
  TouchableOpacity,
  ActivityIndicator,
  FlatList,
  Image,
  ImageBackground,
  ScrollView,
  Linking,
} from "react-native";
import styles from "./Styles";
import { AppIcons, Responsive, Theme } from "../../libs";
import { useAppContext } from "../../Context/AppContext";
import RNHTMLtoPDF from "react-native-html-to-pdf"; // PDF generation
import Share from "react-native-share"; // Sharing library
import RNFS from "react-native-fs"; // File system (if you want to store the PDF)
import { useNavigation } from "@react-navigation/native";
import axios from "axios";
import QRCode from "react-native-qrcode-svg";

import AsyncStorage from "@react-native-async-storage/async-storage";

import { useTranslation } from "react-i18next";
import "../../Translations/i18n";
import { images } from "../../assets";
import NativeModal from "../../Components/Common/NativeModal";

const colors = [
  "#FF0000", // Red
  "#00FF00", // Green
  "#0000FF", // Blue
  "#FFA500", // Orange
  "#800080", // Purple
  "#FFFF00", // Yellow
  "#FFC0CB", // Pink
  "#00FFFF", // Cyan
  "#808080", // Gray
  "#000000", // Black
  "#FFFFFF", // White
  "#A52A2A", // Brown
  "#008000", // Dark Green
  "#ADD8E6", // Light Blue
  "#FFD700", // Gold
  "#FF1493", // Deep Pink
  "#8B0000", // Dark Red
  "#2F4F4F", // Dark Slate Gray
  "#40E0D0", // Turquoise
  "#FF6347", // Tomato
  "#7FFF00", // Chartreuse
  "#DC143C", // Crimson
  "#4682B4", // Steel Blue
  "#DA70D6", // Orchid
  "#B0E0E6", // Powder Blue
  "#D2691E", // Chocolate
  "#F5DEB3", // Wheat
  "#9ACD32", // Yellow Green
  "#708090", // Slate Gray
  "#F08080", // Light Coral
  "#FF7F50", // Coral
  "#6A5ACD", // Slate Blue
  "#20B2AA", // Light Sea Green
  "#FF4500", // Orange Red
  "#BA55D3", // Medium Orchid
  "#CD5C5C", // Indian Red
  "#556B2F", // Dark Olive Green
  "#E6E6FA", // Lavender
  "#6495ED", // Cornflower Blue
  "#FFF8DC", // Cornsilk
  "#F0E68C", // Khaki
  "#191970", // Midnight Blue
  "#87CEEB", // Sky Blue
  "#B22222", // Firebrick
  "#FFE4B5", // Moccasin
  "#ADFF2F", // Green Yellow
  "#9932CC", // Dark Orchid
  "#8FBC8F", // Dark Sea Green
  "#FFB6C1", // Light Pink
  "#C71585", // Medium Violet Red
  "#20B2AA", // Light Sea Green
  "#FF8C00", // Dark Orange
  "#6A5ACD", // Slate Blue
  "#00CED1", // Dark Turquoise
  "#B22222", // Firebrick
  "#3CB371", // Medium Sea Green
];

export default function Template1({ route }) {
  const { getHeight, getWidth } = Responsive;

  const { t, i18n } = useTranslation();

  const {
    selectedClient,
    selectedBusiness,
    selectedItem,
    CapturedSignature,
    selectedLanguage,
    selectedCurrency,
    shippingCharges,
    selectedTerms,
    selectedPayments,
    invoiceNumber,
    invoiceTitle,
    startDate,
    endDate,
    newInvoiveStatus,
    allItemsTotal,
    discountNumber,
    grandTotal,
    selectedTaxItem,
  } = useAppContext();
  const navigation = useNavigation();

  const { invoiceId } = route.params || {}; // Get the passed invoice ID
  const [invoiceDetails, setInvoiceDetails] = useState(null);
  const [loading, setLoading] = useState(true);
  const [selectedColor, setSelectedColor] = useState("");
  const [openHeaderBgModal, setOpenHeaderBgModal] = useState(false);
  const [selectedTextColor, setSelectedTextColor] = useState("");
  const [selectedInvoiceTextColor, setSelectedInvoiceTextColor] = useState("");
  const [selectedSubTitlesColor, setSelectedSubTitlesColor] = useState("");

  const [openHeaderTextModal, setOpenHeaderTextModal] = useState(false);
  const [openTitleTextModal, setOpenTitleTextModal] = useState(false);
  const [openSubTitlesModal, setOpenSubTitlesModal] = useState(false);

  useEffect(() => {
    if (selectedLanguage) {
      i18n.changeLanguage(selectedLanguage);
    }
  }, [selectedLanguage]);

  const getInvoiceDetails = async () => {
    try {
      const token = await AsyncStorage.getItem("userToken");

      setLoading(true);

      const url = `https://invoice-maker-app-wsshi.ondigitalocean.app/api/invoice/${invoiceId}`; // your GET endpoint

      const response = await axios.get(url, {
        headers: {
          Authorization: `Bearer ${token}`, // include token for auth
        },
      });

      if (response.status === 200) {
        console.log("✅ Invoices fetched:", response.data);
        // You can set this to state for FlatList
        // setInvoices(response.data);
        // setInvoiceDetails(response.data);
        setInvoiceDetails(response.data || { items: [] });
      }
    } catch (error) {
      console.log(
        "❌ Error fetching invoices:",
        error.response?.data || error.message
      );
      Alert.alert("Error", error.message);
    } finally {
      setLoading(false);
    }
  };

  useEffect(() => {
    getInvoiceDetails();
  }, [invoiceId]);

  if (loading) {
    return <ActivityIndicator size="large" color="#0000ff" />;
  }

  // Dynamically calculate total amount
  const totalAmount = invoiceDetails?.items?.length
    ? invoiceDetails.items.reduce(
        (sum, item) => sum + parseFloat(item.amount || 0),
        0
      )
    : selectedItem.reduce(
        (sum, item) => sum + parseFloat(item.totalAmount || 0),
        0
      );

  // Function to generate the item rows dynamically
  const generateItemRows = (items) => {
    return items
      .map(
        (item) => `
      <tr>
        <td>${item.itemName || "N/A"}</td>
        <td>${item.itemQuantity || "N/A"}</td>
        <td>${item.itemPrice || "N/A"}</td>
        <td>${item.discount + "%" || "N/A"}</td>

        <td>${
          item.total || (item.itemPrice * item.itemQuantity).toFixed(2)
        }</td>
      </tr>
    `
      )
      .join("");
  };

  const generateTaxRows = (taxes) => {
    return taxes
      .map(
        (tax) => `

        <div style="display: flex; justify-content: space-between;">
        <span style="font-weight: 600; font-size: 18px;">  ${tax.taxName}</span>
        <span style="font-size: 18px;font-weight: 500;">
        ${tax.taxRate}%
        </span>
        </div>
      `
      )
      .join("");
  };

  const handleSharePDF = async () => {
    try {
      // Dynamically create rows from selected items or invoice details
      const itemRows =
        invoiceDetails?.items && invoiceDetails.items.length > 0
          ? generateItemRows(invoiceDetails.items)
          : generateItemRows(selectedItem);

      const taxRows =
        invoiceDetails?.taxes && invoiceDetails.taxes.length > 0
          ? generateTaxRows(invoiceDetails.taxes)
          : generateTaxRows(selectedTaxItem);

      // Generate the PDF
      const options = {
        html: `
        <html>
        <head>
        <style>
        * {
          -webkit-print-color-adjust: exact !important;
          print-color-adjust: exact !important;
        }
      </style>

        <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
        <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap');
        
          body {
            font-family: 'Montserrat', sans-serif;
      color: #333;
      margin: 0;
      padding: 0;
      // background-image: url('https://www.highhillstours.pk/wp-content/uploads/2025/07/pinkTemplate.png');
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
    }
    
    
          .container {
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
            padding: 0px;
            /*background-color: #ffffff;*/
            // border: 1px solid #ddd;
            // box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            position: relative;
          }
    
          .logo {
            display: flex;
            justify-content: center; 
            align-items: center;    
            margin-top: 15px;       
            width: 100%;   /* make container full width */
          }
          
          .logo img {
            width: 150px;   /* increase logo size */
            height: 150px;  /* keep same ratio if square logo */
            object-fit: contain; /* prevent distortion */
          }
          
    
          .header {
            text-align: center;
            margin-bottom: 30px;
          }
    
          .header h1 {
            font-size: 36px;
            color: #000;
            margin: 0;
          }
    
          .invoice-details {
                 margin-top: 10.5%;
            text-align: right;
            margin-bottom: 20px;
            margin-right: 20px;
          }
    
          .invoice-details p {
            margin: 5px 0;
            font-size: 20px;
          }
    
          .invoice-details .bold {
            font-weight: bold;
          }
    
          .section {
            margin-bottom: 20px;
          }
    
          .contact-info {
               /*margin-top: 10px;*/
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            margin-right: 20px;
          }
    
          .from,
          .bill-to {
            width: 48%;
            margin-right: 5px;
          }
    
          .from {
            text-align: left;
            margin-left: 20px;
          }
    
          .bill-to {
            text-align: right;
          }
    
          .section h2 {
            font-size: 28px;
            color: #000;
            margin-bottom: 10px;
          }
    
          .section p {
            font-size: 20px;
            line-height: 1.6;
            margin: 5px 0;
          }
    
          .table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
          }
    
          .table th,
          .table td {
            padding: 12px;
            text-align: center;
            border-bottom: 1px solid rgba(0, 0, 0, 0.3);
            
          }
    
          .table th {
            background-color:${selectedColor ? selectedColor : "#064488"};
            color:${selectedTextColor ? selectedTextColor : Theme.colors.white};
            font-size: 16px;
          
          }
          
    
          .table td {
            font-size: 16px;
            font-weight: 500;
          }
    
          .footer {
            text-align: center;
            margin-top: 30px;
            font-size: 12px;
            color: #888;
          }
    
          .footer p {
            margin: 5px 0;
          }
    
          .invoice-image {
            text-align: right;
            margin-top: 20px;
            margin-right: 25px;
          }
    
          .invoice-image img {
            width: 100px;
            height: auto;
          }
    
          .summary p {
            text-align: right;
            font-size: 20px;
            font-weight: bold;
            margin: 5px 0;
            margin-right:20px;
          }
        </style>
      </head>
        <body style="position: relative; margin:0; padding:0;">
        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABYYAAAfQCAYAAAB2Xou3AAAACXBIWXMAABpMAAAaTAEcLDmcAAAE42lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSfvu78nIGlkPSdXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQnPz4KPHg6eG1wbWV0YSB4bWxuczp4PSdhZG9iZTpuczptZXRhLyc+CjxyZGY6UkRGIHhtbG5zOnJkZj0naHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyc+CgogPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9JycKICB4bWxuczpBdHRyaWI9J2h0dHA6Ly9ucy5hdHRyaWJ1dGlvbi5jb20vYWRzLzEuMC8nPgogIDxBdHRyaWI6QWRzPgogICA8cmRmOlNlcT4KICAgIDxyZGY6bGkgcmRmOnBhcnNlVHlwZT0nUmVzb3VyY2UnPgogICAgIDxBdHRyaWI6Q3JlYXRlZD4yMDI1LTA4LTI4PC9BdHRyaWI6Q3JlYXRlZD4KICAgICA8QXR0cmliOkV4dElkPjUyYzU1NmZmLTkxNTktNDY0ZC1hYzRkLTU3NGVjZWM0NmQ1MTwvQXR0cmliOkV4dElkPgogICAgIDxBdHRyaWI6RmJJZD41MjUyNjU5MTQxNzk1ODA8L0F0dHJpYjpGYklkPgogICAgIDxBdHRyaWI6VG91Y2hUeXBlPjI8L0F0dHJpYjpUb3VjaFR5cGU+CiAgICA8L3JkZjpsaT4KICAgPC9yZGY6U2VxPgogIDwvQXR0cmliOkFkcz4KIDwvcmRmOkRlc2NyaXB0aW9uPgoKIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PScnCiAgeG1sbnM6ZGM9J2h0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvJz4KICA8ZGM6dGl0bGU+CiAgIDxyZGY6QWx0PgogICAgPHJkZjpsaSB4bWw6bGFuZz0neC1kZWZhdWx0Jz5SZWQgU2ltcGxlIFJlc3RhdXJhbnQgSW52b2ljZSAtIDE8L3JkZjpsaT4KICAgPC9yZGY6QWx0PgogIDwvZGM6dGl0bGU+CiA8L3JkZjpEZXNjcmlwdGlvbj4KCiA8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xDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAICZAAAA///s2IEAAAAAgCB/60EujMQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADATAAAA///s2IEAAAAAgCB/60EujMQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAmQAAAP//7NiBAAAAAIAgf+tBLozEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwEwAAAP//7NiBAAAAAIAgf+tBLozEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgJkAAAD//+zYgQAAAACAIH/rQS6MxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMBMAAAD//+zYgQAAAACAIH/rQS6MxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAICZAAAA///s2IEAAAAAgCB/60EujMQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IY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AACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAICZAAAA///s2IEAAAAAgCB/60EujMQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADATAAAA///s2IEAAAAAgCB/60EujMQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAmQAAAP//7NiBAAAAAIAgf+tBLozEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwEwAAAP//7NiBAAAAAIAgf+tBLozEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgJkAAAD//+zYgQAAAACAIH/rQS6MxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMBMAAAD//+zYgQAAAACAIH/rQS6MxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAICZAAAA///s2IEAAAAAgCB/60EujMQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAA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GAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAICZAAAA///s2IEAAAAAgCB/60EujMQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAjhgEAAAAAZsQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADATAAAA///s2IEAAAAAgCB/60EujMQwAAAAAMCMGAYAAAAAmBHDAAAAAAAzYhgAAAAAYEYMAwAAAADMiGEAAAAAgBkxDAAAAAAwI4YBAAAAAGbEMAAAAADAjBgGAAAAAJgRwwAAAAAAM2IYAAAAAGBGDAMAAAAAzIhhAAAAAIAZMQwAAAAAMCOGAQAAAABmxDAAAAAAwIwYBgAAAACYEcMAAAAAADNiGAAAAABgRgwDAAAAAMyIYQAAAACAGTEMAAAAADAj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" 
             style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: -1;" />
        <div style="position: relative; z-index: 1;">
          
        </div>

        <div class="container">
      
        ${
          (selectedBusiness?.logo || invoiceDetails?.businessLogo)
            ? `
              <div class="logo">
                <img 
                  src="${selectedBusiness?.logo || invoiceDetails?.businessLogo}" 
                  alt="Business Logo"
                />
              </div>
            `
            : ''
        }
        
  
      



    



        <!-- Invoice Name and Date Section -->
        <div class="section contact-info">
          <div class="from">



        
       

       
    
          
            <h1 style="font-size: 50px; font-weight: bold; color:${
              selectedInvoiceTextColor
                ? selectedInvoiceTextColor
                : Theme.colors.black
            }; text-align: center; margin-top: 40px; margin-bottom: 0px;">
          ${invoiceTitle ? invoiceTitle : invoiceDetails.invoiceTitle}
          </h1>
         
        
          </div>



          <div class="bill-to">
 
            <div class="invoice-details">
            <p>
            <span 
            style="color: ${
              selectedSubTitlesColor ? selectedSubTitlesColor : Theme.colors.black
            }; font-weight:bold; font-size:18px;"
            >
              INVOICE#
            </span>
            <span 
              style="font-weight:500; font-size:18px;"
            >
              ${invoiceNumber ? invoiceNumber : invoiceDetails.invoiceNumber}
            </span>
          </p>
          
          <p>
          <span 
          style="color: ${
            selectedSubTitlesColor ? selectedSubTitlesColor : Theme.colors.black
          }; font-weight:bold; font-size:18px;"
          >
            ${t("dateCreated")}
          </span>
          <span style="font-weight:500; font-size:18px;">
            ${
              startDate
                ? startDate
                : new Date(invoiceDetails.dateCreated).toISOString().split("T")[0]
            }
          </span>
        </p>
        


        <p>
        <span 
        style="color: ${
          selectedSubTitlesColor ? selectedSubTitlesColor : Theme.colors.black
        }; font-weight:bold; font-size:18px;"
        >
          ${t("dueDate")}:
        </span>
        <span style="font-weight:500; font-size:18px;">
          ${
            endDate
              ? new Date(endDate).toISOString().split("T")[0]
              : new Date(invoiceDetails.DueIn).toISOString().split("T")[0]
          }
        </span>
      </p>
      
          


            </div>








          </div>
        </div>








  
        <!-- From and Bill To Section -->
        <div class="section contact-info">
          <div class="from">
            <h2 style="color: ${
              selectedSubTitlesColor
                ? selectedSubTitlesColor
                : Theme.colors.black
            };font-size:22px">${t("from")}</h2>
            <p>
              <strong>${
                selectedBusiness
                  ? selectedBusiness.businessName
                  : invoiceDetails.businessName
              }</strong>
            </p>
            <p  style="font-weight:500; font-size:18px;">
              ${
                selectedBusiness
                  ? selectedBusiness.email
                  : invoiceDetails.businessEmail
              }
            </p>
            <p style="font-weight:500; font-size:18px;">
              ${
                selectedBusiness
                  ? selectedBusiness.phone
                  : invoiceDetails.businessPhone
              }
            </p>
          </div>
          <div class="bill-to">
            <h2 style="color: ${
              selectedSubTitlesColor
                ? selectedSubTitlesColor
                : Theme.colors.black
            };font-size:22px">${t("billTo")}</h2>
            <p>
              <strong>${
                selectedClient
                  ? selectedClient.clientName
                  : invoiceDetails.clientName
              }</strong>
            </p>
            <p style="font-weight:500; font-size:18px;">
              ${
                selectedClient
                  ? selectedClient.email
                  : invoiceDetails.clientEmail
              }
            </p>
            <p style="font-weight:500; font-size:18px;">
              ${
                selectedClient
                  ? selectedClient.phone
                  : invoiceDetails.clientPhone
              }
            </p>
          </div>
        </div>
  
        <!-- Items Table -->
        <div class="section">
          <table class="table">
            <thead>
              <tr>
                <th>${t("items")}</th>
                <th>${t("quantity")}</th>
                <th>${t("price")} (${
                  selectedCurrency
                  ? selectedCurrency.currencyCode
                  : invoiceDetails?.currency
        })</th>
                <th>${t("discount")}%</th>
                <th>${t("total")} (${
                  selectedCurrency
                  ? selectedCurrency.currencyCode
                  : invoiceDetails?.currency
         
        })</th>
              </tr>
            </thead>
            <tbody>
              ${itemRows}
            </tbody>
          </table>






          <!-- Payment Terms and Total Section -->
          <div class="section contact-info">
            <div class="from">

            <!-- Terms Section -->
            <div class="payment-method">
              <h3 style="margin: 0 0 5px 0; font-size: 16px; font-weight: bold; color: ${
                selectedSubTitlesColor
                  ? selectedSubTitlesColor
                  : Theme.colors.black
              };">Terms & Conditions</h3>
              <p style="margin: 0 0 0px 0; font-size: 16px; font-weight:500;">

             
              ${
                selectedTerms
                  ? selectedTerms.termsDesc
                  : invoiceDetails?.termsConditions
              }
              </p>

            

            
            
            </div>

            <!-- Payment Method Section -->
            <div class="payment-method">
              <h3 style="margin: 15 0 5px 0; font-size: 16px; font-weight: bold; color: ${
                selectedSubTitlesColor
                  ? selectedSubTitlesColor
                  : Theme.colors.black
              };"">Payment Method</h3>
              <p style="margin: 0 0 0px 0; font-size:16px;font-weight:500;">
              ${
                selectedPayments
                  ? selectedPayments.paymentMethod || ""
                  : invoiceDetails?.paymentMethod || ""
              }
              </p>
              <p style="margin: 0 0 0px 0; font-size: 16px;font-weight:500; ">
              ${
                selectedPayments
                  ? selectedPayments.paymentDesc || ""
                  : invoiceDetails?.paymentDesc || ""
              }
              </p>
            </div>

            <!-- QR Code + Text Side by Side -->
            <div style="display: inline-flex; align-items: center; gap: 10px; margin-top: 10px;">
              <a href="${
                selectedPayments?.paymentLink || invoiceDetails?.paymentLink
              }" target="_blank">
                <img 
                  src="https://api.qrserver.com/v1/create-qr-code/?size=55x55&data=${
                    selectedPayments?.paymentLink || invoiceDetails?.paymentLink
                  }" 
                  alt="QR Code"
                  style="display: block; cursor: pointer;"
                />
              </a>
              <a href="${
                selectedPayments?.paymentLink || invoiceDetails?.paymentLink
              }" target="_blank" 
                 style="font-size: 16px; font-weight: bold; color: ${
                   selectedSubTitlesColor
                     ? selectedSubTitlesColor
                     : Theme.colors.black
                 };"; text-decoration: none;">
                Scan or Click & Pay
              </a>
            </div>
  
         
          
           
            
            
            </div>
            <div class="bill-to">

            <div style="display: flex; justify-content: space-between;">
  <span style="font-weight: 600; font-size: 18px;">Total:</span>
  <span style="font-size: 18px; font-weight: 500;">
    ${
      selectedCurrency
        ? selectedCurrency.currencyCode
        : invoiceDetails?.currency
    } ${(allItemsTotal ?? invoiceDetails.itemsTotal ?? 0).toFixed(2)}
  </span>
</div>

<div style="display: flex; justify-content: space-between;">
<span style="font-weight: 600; font-size: 18px;">Shipping:</span>
<span style="font-size: 18px;font-weight: 500;">
${selectedCurrency ? selectedCurrency.currencyCode : invoiceDetails?.currency}
${(shippingCharges ?? invoiceDetails?.shipping ?? 0).toFixed(2)}
</span>
</div>

<div style="display: flex; justify-content: space-between;">
<span style="font-weight: 600; font-size: 18px;">Discount:</span>
<span style="font-size: 18px;font-weight: 500;">
${discountNumber ?? invoiceDetails.discount ?? 0}% 
</span>
</div>

${taxRows}


        
          
        
        
            <!-- Grand Total Row (Red Background) -->

            <div style="display: flex; justify-content: space-between; background-color: ${
              selectedColor ? selectedColor : "#064488"
            };  color:${
          selectedTextColor ? selectedTextColor : Theme.colors.white
        }; padding: 9px; margin-top: 10px;">
            <span style="font-weight:800; font-size: 20px;">Sub Total:</span>
            <span style="font-size: 20px; font-weight:800;">
            ${
              selectedCurrency
                ? selectedCurrency.currencyCode
                : invoiceDetails.currency
            }
            ${
              grandTotal
                ? grandTotal.toFixed(2)
                : invoiceDetails.amount.toFixed(2)
            }
            </span>
            </div>











           
   
             
            </div>
          </div>


</div>
        
     
        

  
       
  
        <!-- Signature -->
        <div class="invoice-image">
          <img
            src="${
              CapturedSignature
                ? CapturedSignature
                : invoiceDetails.CapturedSignature
            }"
            alt="${t("signature")}"
          />
          <p>${t("signature")}</p>
        </div>
      </div>
      </body>



      
      
      </html>


      
      `,
        fileName: "invoice",
        directory: Platform.OS === "ios" ? "Documents" : undefined,
      };

      const pdf = await RNHTMLtoPDF.convert(options);
      const { filePath } = pdf;

      Alert.alert("Success", `PDF generated at ${filePath}`);

      const shareOptions = {
        title: "Share Invoice",
        url: Platform.OS === "android" ? `file://${filePath}` : filePath,
        type: "application/pdf",
        failOnCancel: false
      };

      await Share.open(shareOptions);
    } catch (error) {
      console.error("Error generating or sharing PDF", error);
      Alert.alert("Error", "There was an issue generating or sharing the PDF.");
    }
  };

  return (
    <View style={styles.container}>
      <StatusBar translucent backgroundColor={"transparent"} />
      <View style={styles.header}>
        <View style={styles.headerArrowAndText}>
          <AppIcons.backArrow size={27} color={Theme.colors.white} />
          <Text style={styles.headingText}>Template 1</Text>
        </View>
        <AppIcons.DoneIcon size={27} color={Theme.colors.white} />
      </View>
      <ScrollView>
        <ImageBackground
          source={images.yellowTemplate}
          style={styles.blueTemplate}
       
        >
          <View
            onPress={() =>
              navigation.navigate("Template1", { invoiceId: invoiceId })
            }
            style={styles.dataBox}
          >

{(selectedBusiness?.logo || invoiceDetails?.businessLogo) && (
  <View style={styles.logoWrapper}>
    <Image
      style={styles.businessLogo}
      source={{
        uri: selectedBusiness?.logo || invoiceDetails?.businessLogo,
      }}
    />
  </View>
)}



            <View style={styles.dataBoxInner}>
              <View style={styles.invAndMeta}>
              <View>
                  <Text style={[styles.invTitle,{color:selectedInvoiceTextColor?selectedInvoiceTextColor:Theme.colors.black}]}>
                  {invoiceTitle
                        ? invoiceTitle
                        : invoiceDetails?.invoiceTitle}
                  </Text>
                </View>

                {/* <View style={styles.logoWrapper}>
                  <Image
                    style={styles.businessLogo}
                    source={{
                      uri: selectedBusiness
                        ? selectedBusiness.imageUrl
                        : invoiceDetails.businessLogo,
                    }}
                  />
                </View> */}

<View style={styles.metaWrap}>
                  <View>
                    <Text style={[styles.invTitleText, {
                      color: selectedSubTitlesColor
                        ? selectedSubTitlesColor
                        : Theme.colors.black,
                    },]}>
                      {t("invoiceTitle")}</Text>
                    <Text style={[styles.invTitleText, {
                      color: selectedSubTitlesColor
                        ? selectedSubTitlesColor
                        : Theme.colors.black,
                    },]}>{t("dateCreated")}</Text>
                   
                    {invoiceDetails?.Status === "UNPAID" && (
                       <Text style={[styles.invTitleText, {
                        color: selectedSubTitlesColor
                          ? selectedSubTitlesColor
                          : Theme.colors.black,
                      },]}>{t("dueDate")}</Text>
                    )}
                    {invoiceDetails?.Status === "PAID" && (
                      <Text style={[styles.invTitleText, {
                        color: selectedSubTitlesColor
                          ? selectedSubTitlesColor
                          : Theme.colors.black,
                      },]}>INVOICE STATUS</Text>
                    )}
                    {newInvoiveStatus === "PAID" && (
                      <Text style={[styles.invTitleText, {
                        color: selectedSubTitlesColor
                          ? selectedSubTitlesColor
                          : Theme.colors.black,
                      },]}>INVOICE STATUS</Text>
                    )}
                  </View>
                  <View>
                    <Text style={styles.invDescText}>
                      {invoiceNumber
                        ? invoiceNumber
                        : invoiceDetails?.invoiceNumber}
                    </Text>

                    <Text style={styles.invDescText}>
                      {
                        startDate
                          ? startDate
                          : invoiceDetails?.dateCreated
                          ? new Date(invoiceDetails.dateCreated)
                              .toISOString()
                              .split("T")[0]
                          : "" // fallback if no date
                      }
                    </Text>
                   

{invoiceDetails?.Status === "UNPAID" && (
  <Text style={styles.invDescText}>
    {endDate 
      ? new Date(endDate).toISOString().split("T")[0] 
      : invoiceDetails?.DueIn 
        ? new Date(invoiceDetails.DueIn).toISOString().split("T")[0] 
        : ""}
  </Text>
)}

                    {invoiceDetails?.Status === "PAID" && (
                      <Text style={styles.invDescText}>PAID</Text>
                    )}
                    {newInvoiveStatus === "PAID" && (
                      <Text style={styles.invDescText}>PAID</Text>
                    )}
                  </View>
                </View>
              </View>
            </View>
            <View style={styles.border} />
            <View style={styles.fromandToWrap}>
              <View>
                <Text
                  style={[
                    styles.fromTitle,
                    {
                      color: selectedSubTitlesColor
                        ? selectedSubTitlesColor
                        : Theme.colors.black,
                    },
                  ]}
                >
                  {t("from")}
                </Text>
                <Text style={styles.fromDesc}>
                  {selectedBusiness
                    ? selectedBusiness.businessName
                    : invoiceDetails?.businessName}
                </Text>
                <Text style={styles.fromDesc}>
                  {selectedBusiness
                    ? selectedBusiness.email
                    : invoiceDetails?.businessEmail}
                </Text>
                <Text style={styles.fromDesc}>
                  {selectedBusiness
                    ? selectedBusiness.phone
                    : invoiceDetails?.businessPhone}
                </Text>
              </View>
              <View>
                <Text
                  style={[
                    styles.fromTitle,
                    {
                      color: selectedSubTitlesColor
                        ? selectedSubTitlesColor
                        : Theme.colors.black,
                    },
                  ]}
                >
                  {t("billTo")}
                </Text>
                <Text style={styles.fromDesc}>
                  {selectedClient
                    ? selectedClient.clientName
                    : invoiceDetails?.clientName}
                </Text>
                <Text style={styles.fromDesc}>
                  {selectedClient
                    ? selectedClient.email
                    : invoiceDetails?.clientEmail}
                </Text>
                <Text style={styles.fromDesc}>
                  {selectedClient
                    ? selectedClient.phone
                    : invoiceDetails?.clientPhone}
                </Text>
              </View>
            </View>

            {/* items headings */}
            <View
              style={[
                styles.headingMainWrap,
                { backgroundColor: selectedColor ? selectedColor : "#f974aa" },
              ]}
            >
              <View style={[styles.itemHeadWrap, { width: getWidth(31) }]}>
                <Text
                  style={[
                    styles.headText,
                    {
                      color: selectedTextColor
                        ? selectedTextColor
                        : Theme.colors.white,
                    },
                  ]}
                >
                  {t("items")}
                </Text>
              </View>
              <View style={[styles.itemHeadWrap, { width: getWidth(13) }]}>
                <Text
                  style={[
                    styles.headText,
                    {
                      color: selectedTextColor
                        ? selectedTextColor
                        : Theme.colors.white,
                    },
                  ]}
                >
                  {t("quantity")}
                </Text>
              </View>
              <View style={[styles.itemHeadWrap, { width: getWidth(14) }]}>
                <Text
                  style={[
                    styles.headText,
                    {
                      color: selectedTextColor
                        ? selectedTextColor
                        : Theme.colors.white,
                    },
                  ]}
                >
                  {t("price")} (
                  {selectedCurrency
                    ? selectedCurrency?.currencyCode
                    : invoiceDetails?.currency}
                  )
                </Text>
              </View>
              <View style={[styles.itemHeadWrap, { width: getWidth(11) }]}>
                <Text
                  style={[
                    styles.headText,
                    {
                      color: selectedTextColor
                        ? selectedTextColor
                        : Theme.colors.white,
                    },
                  ]}
                >
                  {t("discount")}
                </Text>
              </View>

              <View style={[styles.itemHeadWrap, { width: getWidth(16) }]}>
                <Text
                  style={[
                    styles.headText,
                    {
                      color: selectedTextColor
                        ? selectedTextColor
                        : Theme.colors.white,
                    },
                  ]}
                >
                  {t("total")} (
                  {selectedCurrency
                    ? selectedCurrency?.currencyCode
                    : invoiceDetails?.currency}
                  )
                </Text>
              </View>
            </View>

            <View>
              <FlatList
                data={
                  invoiceDetails?.items && invoiceDetails?.items.length > 0
                    ? invoiceDetails.items
                    : selectedItem
                }
                renderItem={({ item }) => (
                  <View style={styles.itemsMainWrap}>
                    <View
                      style={[
                        styles.itemDataCell,
                        { width: getWidth(28.5), marginLeft: getWidth(2) },
                      ]}
                    >
                      <Text style={styles.itemName}>{item.itemName}</Text>
                    </View>
                    <View style={styles.itemsWrap}>
                      <View
                        style={[
                          styles.itemDataCell,
                          { width: getWidth(12), marginLeft: getWidth(1) },
                        ]}
                      >
                        <Text style={styles.perItemStyle}>
                          {item.itemQuantity} {item.unit} ✕
                        </Text>
                      </View>

                      <View
                        style={[
                          styles.itemDataCell,
                          { width: getWidth(13.1), marginLeft: getWidth(1) },
                        ]}
                      >
                        <Text style={styles.perItemStyle}>
                          {item.itemPrice}{" "}
                        </Text>
                      </View>

                      <View
                        style={[
                          styles.itemDataCell,
                          { width: getWidth(10), marginLeft: getWidth(1) },
                        ]}
                      >
                        {item.discount >= 1 ? (
                          <Text style={styles.perItemStyle}>
                            {item.discount}%
                          </Text>
                        ) : (
                          <Text style={styles.perItemStyle}>--</Text>
                        )}
                      </View>

                      <View
                        style={[
                          styles.itemDataCell,
                          { width: getWidth(15), marginLeft: getWidth(1) },
                        ]}
                      >
                        <Text style={styles.perItemStyle}>
                          {item.totalAmount}
                        </Text>
                      </View>
                    </View>
                  </View>
                )}
              />
            </View>

            <View style={styles.paymentAndgrandsMainWrap}>
              {/* payments start */}

              <View style={styles.paymentAndTermsWrap}>
                <Text
                  style={[
                    styles.termsTitle,
                    {
                      color: selectedSubTitlesColor
                        ? selectedSubTitlesColor
                        : Theme.colors.black,
                    },
                  ]}
                >
                  Terms and Conditions
                </Text>
                <Text style={styles.termsDesc}>
                  {selectedTerms
                    ? selectedTerms.termsDesc
                    : invoiceDetails?.termsConditions}
                </Text>

                <Text
                  style={[
                    styles.termsTitle,
                    {
                      color: selectedSubTitlesColor
                        ? selectedSubTitlesColor
                        : Theme.colors.black,
                    },
                  ]}
                >
                  Payment Method
                </Text>
                <Text style={styles.termsDesc}>
                  {selectedPayments
                    ? selectedPayments.paymentMethod || ""
                    : invoiceDetails?.paymentMethod || ""}
                </Text>

                <Text style={styles.termsDesc}>
                  {selectedPayments
                    ? selectedPayments.paymentDesc || ""
                    : invoiceDetails?.paymentDesc || ""}
                </Text>

                {(selectedPayments?.paymentLink ||
                  invoiceDetails?.paymentLink) && (
                  <View style={styles.qrMainWrap}>
                    <TouchableOpacity
                      onPress={() =>
                        Linking.openURL(
                          selectedPayments?.paymentLink ||
                            invoiceDetails?.paymentLink
                        )
                      }
                      style={{
                        marginTop: getHeight(0.5),
                        marginLeft: getWidth(2.5),
                      }}
                    >
                      <QRCode
                        value={
                          selectedPayments?.paymentLink ||
                          invoiceDetails?.paymentLink
                        }
                        size={30}
                      />
                    </TouchableOpacity>
                    <Text
                      style={[
                        styles.termsTitle,
                        {
                          color: selectedSubTitlesColor
                            ? selectedSubTitlesColor
                            : Theme.colors.black,
                        },
                      ]}
                    >
                      Scan or Click & Pay
                    </Text>
                  </View>
                )}
              </View>

              {/* payments end */}

              {/* total start */}
              <View style={styles.grandTotalWrap}>
                <View style={styles.singleGrandRow}>
                  <Text style={styles.grandTotalText}>Total</Text>
                  <Text style={styles.grandTotalText}>
                    {selectedCurrency
                      ? selectedCurrency.currencyCode
                      : invoiceDetails?.currency}{" "}
                    {(allItemsTotal ?? invoiceDetails.itemsTotal ?? 0).toFixed(
                      2
                    )}
                  </Text>
                </View>

                {shippingCharges >= 1 || invoiceDetails?.shipping >= 1 ? (
                  <View style={styles.singleGrandRow}>
                    <Text style={styles.grandTotalText}>Shipping</Text>
                    <Text style={styles.grandTotalText}>
                      {"              "}{" "}
                      {selectedCurrency
                        ? selectedCurrency.currencyCode
                        : invoiceDetails?.currency}{" "}
                      {(
                        shippingCharges ??
                        invoiceDetails?.shipping ??
                        0
                      ).toFixed(2)}
                    </Text>
                  </View>
                ) : null}

                {discountNumber >= 1 || invoiceDetails?.discount >= 1 ? (
                  <View style={styles.singleGrandRow}>
                    <Text style={styles.grandTotalText}>Discount</Text>
                    <Text style={styles.grandTotalText}>
                      {discountNumber ?? invoiceDetails.discount ?? 0}%
                    </Text>
                  </View>
                ) : null}

                <FlatList
                  data={
                    invoiceDetails?.taxes && invoiceDetails?.taxes.length > 0
                      ? invoiceDetails.taxes
                      : selectedTaxItem
                  }
                  renderItem={({ item }) => (
                    <View style={styles.singleGrandRow}>
                      <Text style={styles.grandTotalText}>{item.taxName}</Text>
                      <Text style={styles.grandTotalText}>{item.taxRate}%</Text>
                    </View>
                  )}
                />

                <View
                  style={[
                    styles.singleGrandRow,
                    {
                      backgroundColor: selectedColor
                        ? selectedColor
                        : "#f974aa",
                    },
                  ]}
                >
                  <Text
                    style={[
                      styles.grandTotalText,
                      {
                        color: selectedTextColor
                          ? selectedTextColor
                          : Theme.colors.white,
                      },
                    ]}
                  >
                    Sub Total
                  </Text>
                  <Text
                    style={[
                      styles.grandTotalText,
                      {
                        color: selectedTextColor
                          ? selectedTextColor
                          : Theme.colors.white,
                      },
                    ]}
                  >
                    {selectedCurrency
                      ? selectedCurrency.currencyCode
                      : invoiceDetails.currency}{" "}
                    {grandTotal
                      ? grandTotal.toFixed(2)
                      : invoiceDetails.amount.toFixed(2)}
                  </Text>
                </View>
              </View>

              {/* total end */}
            </View>

            {/* here was that code */}

            {newInvoiveStatus === "PAID" && (
              <View>
                <Image style={styles.paidIcon} source={images.paidIcon} />
              </View>
            )}

            {invoiceDetails?.Status === "PAID" && (
              <View>
                <Image style={styles.paidIcon} source={images.paidIcon} />
              </View>
            )}

            <View style={styles.paymentAndSignatureWrap}>
              <View style={styles.signatureWrap}>
                <Image
                  style={styles.signatureStyle}
                  source={{
                    uri: CapturedSignature
                      ? CapturedSignature
                      : invoiceDetails?.CapturedSignature,
                  }}
                />
              </View>
            </View>
          </View>
        </ImageBackground>

        <NativeModal
          visible={openHeaderBgModal}
          modalTitle={"Header BG Color"}
          children={
            <View style={{ height: getHeight(44) }}>
              <View style={{ alignSelf: "center" }}>
                <FlatList
                  data={colors}
                  numColumns={8} // adjust columns
                  keyExtractor={(item) => item}
                  renderItem={({ item }) => (
                    <TouchableOpacity
                      onPress={() => {
                        setSelectedColor(item);
                        setOpenHeaderBgModal(false);
                      }}
                      style={{
                        backgroundColor: item,
                        width: getWidth(8),
                        height: getHeight(4.5),
                        margin: 5,
                        borderRadius: getHeight(1),
                        borderWidth: selectedColor === item ? 3 : 0,
                        borderColor: "black",
                      }}
                    />
                  )}
                />
                <Text
                  onPress={() => {
                    setSelectedColor(null);
                    setOpenHeaderBgModal(false);
                  }}
                >
                  Reset Color
                </Text>
              </View>
            </View>
          }
        />

        <NativeModal
          visible={openHeaderTextModal}
          modalTitle={"Header Text Color"}
          children={
            <View style={{ height: getHeight(44) }}>
              <View style={{ alignSelf: "center" }}>
                <FlatList
                  data={colors}
                  numColumns={8} // adjust columns
                  keyExtractor={(item) => item}
                  renderItem={({ item }) => (
                    <TouchableOpacity
                      onPress={() => {
                        setSelectedTextColor(item);
                        setOpenHeaderTextModal(false);
                      }}
                      style={{
                        backgroundColor: item,
                        width: getWidth(8),
                        height: getHeight(4.5),
                        margin: 5,
                        borderRadius: getHeight(1),
                        borderWidth: selectedColor === item ? 4 : 0.5,
                        borderColor: "black",
                      }}
                    />
                  )}
                />
                <Text
                  onPress={() => {
                    setSelectedTextColor(null);
                    setOpenHeaderTextModal(false);
                  }}
                >
                  Reset Color
                </Text>
              </View>
            </View>
          }
        />

        <NativeModal
          visible={openTitleTextModal}
          modalTitle={"Titles Text Color"}
          children={
            <View style={{ height: getHeight(44) }}>
              <View style={{ alignSelf: "center" }}>
                <FlatList
                  data={colors}
                  numColumns={8} // adjust columns
                  keyExtractor={(item) => item}
                  renderItem={({ item }) => (
                    <TouchableOpacity
                      onPress={() => {
                        setSelectedInvoiceTextColor(item);
                        setOpenTitleTextModal(false);
                      }}
                      style={{
                        backgroundColor: item,
                        width: getWidth(8),
                        height: getHeight(4.5),
                        margin: 5,
                        borderRadius: getHeight(1),
                        borderWidth: selectedColor === item ? 4 : 0.5,
                        borderColor: "black",
                      }}
                    />
                  )}
                />
                <Text
                  onPress={() => {
                    setSelectedInvoiceTextColor(null);
                    setOpenTitleTextModal(false);
                  }}
                >
                  Reset Color
                </Text>
              </View>
            </View>
          }
        />

        <NativeModal
          visible={openSubTitlesModal}
          modalTitle={"Sub Titles Color"}
          children={
            <View style={{ height: getHeight(44) }}>
              <View style={{ alignSelf: "center" }}>
                <FlatList
                  data={colors}
                  numColumns={8} // adjust columns
                  keyExtractor={(item) => item}
                  renderItem={({ item }) => (
                    <TouchableOpacity
                      onPress={() => {
                        setSelectedSubTitlesColor(item);
                        setOpenSubTitlesModal(false);
                      }}
                      style={{
                        backgroundColor: item,
                        width: getWidth(8),
                        height: getHeight(4.5),
                        margin: 5,
                        borderRadius: getHeight(1),
                        borderWidth: selectedColor === item ? 4 : 0.5,
                        borderColor: "black",
                      }}
                    />
                  )}
                />
                <Text
                  onPress={() => {
                    setSelectedSubTitlesColor(null);
                    setOpenSubTitlesModal(false);
                  }}
                >
                  Reset Color
                </Text>
              </View>
            </View>
          }
        />

        <Text onPress={() => setOpenHeaderBgModal(true)}>
          Select Heading Bg Color
        </Text>

        <Text onPress={() => setOpenHeaderTextModal(true)}>
          Select Heading Text Color
        </Text>

        <Text onPress={() => setOpenTitleTextModal(true)}>Invoice Title</Text>

        <Text onPress={() => setOpenSubTitlesModal(true)}>Sub Titles</Text>

        <Text style={{ color: selectedSubTitlesColor }}>head</Text>

        <Button title="Share" onPress={handleSharePDF} />
      </ScrollView>
    </View>
  );
}
